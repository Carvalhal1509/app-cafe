@using app_cadastro.Enums;
@model Usuarios
@{
    ViewData["Title"] = "Registrar Usuário";
    Layout = "_LayoutDefault";
}

<html lang="pt-br">
<head>
    <title>Login</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" type="text/css" href="~/css/main.css">
    <link rel="stylesheet" type="text/css" href="~/css/util.css">

    <meta name="robots" content="noindex, follow">
    <script nonce="7916c204-387b-4def-821d-7eeb400be49a">(function (w, d) { !function (a, e, t, r) { a.zarazData = a.zarazData || {}; a.zarazData.executed = []; a.zaraz = { deferred: [], listeners: [] }; a.zaraz.q = []; a.zaraz._f = function (e) { return function () { var t = Array.prototype.slice.call(arguments); a.zaraz.q.push({ m: e, a: t }) } }; for (const e of ["track", "set", "debug"]) a.zaraz[e] = a.zaraz._f(e); a.zaraz.init = () => { var t = e.getElementsByTagName(r)[0], z = e.createElement(r), n = e.getElementsByTagName("title")[0]; n && (a.zarazData.t = e.getElementsByTagName("title")[0].text); a.zarazData.x = Math.random(); a.zarazData.w = a.screen.width; a.zarazData.h = a.screen.height; a.zarazData.j = a.innerHeight; a.zarazData.e = a.innerWidth; a.zarazData.l = a.location.href; a.zarazData.r = e.referrer; a.zarazData.k = a.screen.colorDepth; a.zarazData.n = e.characterSet; a.zarazData.o = (new Date).getTimezoneOffset(); a.zarazData.q = []; for (; a.zaraz.q.length;) { const e = a.zaraz.q.shift(); a.zarazData.q.push(e) } z.defer = !0; for (const e of [localStorage, sessionStorage]) Object.keys(e || {}).filter((a => a.startsWith("_zaraz_"))).forEach((t => { try { a.zarazData["z_" + t.slice(7)] = JSON.parse(e.getItem(t)) } catch { a.zarazData["z_" + t.slice(7)] = e.getItem(t) } })); z.referrerPolicy = "origin"; z.src = "/cdn-cgi/zaraz/s.js?z=" + btoa(encodeURIComponent(JSON.stringify(a.zarazData))); t.parentNode.insertBefore(z, t) };["complete", "interactive"].includes(e.readyState) ? zaraz.init() : a.addEventListener("DOMContentLoaded", zaraz.init) }(w, d, 0, "script"); })(window, document);</script>
</head>
<body style="background-color: #b5adad;">

    <section class="vh-100 background-image-registrar">

        <div class="mask d-flex align-items-center h-100 gradient-custom-3">
            <div class="container h-100">
                <div class="row d-flex justify-content-center align-items-center h-100">
                    <div class="col-12 col-md-9 col-lg-7 col-xl-6">
                        <div class="card-registro">
                            <div class="card-body p-5">
                                <span class="login100-form-title">
                                    Registro de novo Usuario
                                </span>
                                <div class="col-sm-12">
                                    <div id="errorModal" style="display: none">
                                        <div id="msgError" class="alert alert-danger">
                                            <i class="fa fa-ban"></i>
                                            <button class="close" onclick="fechar_alerta();" aria-hidden="true" type="button">×</button>

                                            <span id="erroMsg"></span>
                                        </div>
                                    </div>
                                    <div id="sucessModal" style="display: none">
                                        <div id="msgSucess" class="alert alert-success">
                                            <i class="fa fa-ban"></i>
                                            <button class="close" onclick="fechar_alerta();" aria-hidden="true" type="button">×</button>

                                            <span id="sucessMsg"></span>
                                        </div>
                                    </div>
                                </div>

                                <div class="wrap-input100 validate-input" data-validate="Name is required">
                                    <span class="label-input100">Nome completo*:</span>
                                    <input class="input100" type="text" id="nome" name="nome" placeholder="Ex: João Pedro dos Santos">
                                    <span class="focus-input100"></span>
                                    @Html.ValidationMessageFor(x => x.Nome)
                                </div>
                                <div class="wrap-input100 validate-input" data-validate="Valid email is required: ex@abc.xyz">
                                    <span class="label-input100">Email*:</span>
                                    <input class="input100" type="email" required id="email" name="email" placeholder="Ex: joaopedro@teste.com.br">
                                    <span class="focus-input100"></span>
                                    @Html.ValidationMessageFor(x => x.Email)
                                </div>
                                <div class="wrap-input100 validate-input" data-validate="Username is required">
                                    <span class="label-input100">Confirmar Email*:</span>
                                    <input class="input100" type="email" required id="confirmarEmail" name="confirmarEmail" placeholder="Ex: joaopedro@teste.com.br">
                                    <span class="focus-input100"></span>
                                    @Html.ValidationMessageFor(x => x.Email)
                                </div>
                                <div class="wrap-input100 validate-input" data-validate="Senha">
                                    <span class="label-input100">Senha*:</span>
                                    <input class="input100" type="password" id="senha" name="senha" placeholder="*************">
                                    <span class="focus-input100"></span>
                                    @Html.ValidationMessageFor(x => x.Senha)
                                </div>
                                <div class="wrap-input100 validate-input" data-validate="Repeat Password is required">
                                    <span class="label-input100">Confirmar Senha*:</span>
                                    <input class="input100" type="password" id="confirmarSenha" name="confirmarSenha" placeholder="*************">
                                    <span class="focus-input100"></span>
                                    @Html.ValidationMessageFor(x => x.Senha)
                                </div>
                                <div class="wrap-input100 validate-input" data-validate="Repeat Password is required">
                                    <span class="label-input100">Setor*:</span>
                                    <select asp-for="Setor" class="input100" id="setor" name="setor">
                                        <option value="@SetorEnum.Atendimento">Atendimento</option>
                                        <option value="@SetorEnum.EGP">EGP</option>
                                        <option value="@SetorEnum.InfraEstrutura">Infraestrutura</option>
                                        <option value="@SetorEnum.PlataformaAlta">Plataforma Alta</option>
                                        <option value="@SetorEnum.PlataformaBaixa">Plataforma Baixa</option>
                                        <option value="@SetorEnum.Requisitos">Requisitos</option>
                                        <option value="@SetorEnum.Suporte">Suporte</option>
                                    </select>
                                    <span class="focus-input100"></span>
                                    @Html.ValidationMessageFor(x => x.Setor)

                                </div>
                                <div class="wrap-input100 validate-input" data-validate="Repeat Password is required">
                                    <span class="label-input100">Data de Nascimento:</span>
                                    <input class="input100" type="date" id="data" name="data" placeholder="DD/MM/AAAA">
                                    <span class="focus-input100"></span>
                                </div>
                                <div class="wrap-input100 validate-input" data-validate="Repeat Password is required">
                                    <span class="label-input100">Telefone*:</span>
                                    <input class="input100" type="text" id="telefone" name="telefone" maxlength="11" placeholder="Ex: 71988889999">
                                    <span class="focus-input100"></span>
                                    @Html.ValidationMessageFor(x => x.Celular)

                                </div>
                                <div class="container-login100-form-btn">
                                    <div class="wrap-login100-form-btn">
                                        <div class="login100-form-bgbtn"></div>
                                        <button onclick="SalvarUsuario()" class="login100-form-btn">
                                            Registrar
                                        </button>
                                    </div>
                                    <a asp-controller="Login" asp-action="Index" role="button" class="dis-block txt3 hov1 p-r-30 p-l-30">
                                        Voltar
                                        <i class="fa fa-long-arrow-right m-l-5"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</body>
</html>


<script type="text/javascript">

    $('#telefone').on('keypress', maskNumber);

    function maskNumber(evt) {
        evt = (evt) ? evt : window.event;
        var charCode = (evt.which) ? evt.which : evt.keyCode;
        if ((charCode > 31 && charCode < 48) || charCode > 57) {
            return false;
        }
        return true;
    }

    function SalvarUsuario()
    {
    $('#msgError #erroMsg').html();
    $('#item_form #msgError').hide();
    $.ajax({
        type: 'POST',
        data: {
            'Usuario.Senha': $('#senha').val(),
            'informacaoSenha2': $('#confirmarSenha').val(),
            'Usuario.Email': $('#email').val(),
            'informacaoEmail2': $('#confirmarEmail').val(),
            'Usuario.Celular': $('#telefone').val(),
            'Usuario.Nome': $('#nome').val(),
            'Usuario.Aniversario': $('#data').val(),
            'Usuario.Setor': $('#setor').val(),
        },
        url: '@Url.Action("SalvarUsuario", "Usuario")',
        success: function (result)
        {
            $('.overlay').hide();
            $('#msgSucess #sucessMsg').html('Cadastro efetuado com sucesso!!!');
            $('#sucessModal').show();
            $('#senha').val('');
            $('#confirmarSenha').val('');
            $('#email').val('');
            $('#confirmarEmail').val('');
            $('#telefone').val('');
            $('#nome').val('');
            $('#data').val('');
        },
        error: function (error)
        {
            $('#msgError #erroMsg').html(error.responseJSON.message);
            $('#errorModal').show();
        },
    });
    }

    function fechar_alerta() {
        $('#errorModal').hide();
        $('#sucessModal').hide();
    }
</script>